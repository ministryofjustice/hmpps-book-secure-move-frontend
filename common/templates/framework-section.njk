{% extends "layouts/base.njk" %}

{% block pageTitle %}
  {{ t("person-escort-record::section_overview", {
    section: sectionTitle
  }) }}
  – {{ t("assessment::page_title", { context: i18nContext }) }}
  – {{ SERVICE_NAME }}
{% endblock %}

{% macro backLink() %}
  {% if moveId %}
    {{ govukBackLink({
      text: t("actions::back_to_move"),
      href: "/move/" + moveId
    }) }}
  {% endif %}
{% endmacro %}

{% block beforeContent %}
  {{ backLink() }}

  {{ super() }}
{% endblock %}

{% block content %}
  <header class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l govuk-!-margin-bottom-9">
        {{ t("person-escort-record::section_overview", {
          section: sectionTitle
        }) }}
      </h1>
    </div>
  </header>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-three-quarters">
      {% if not isEditable %}
        {{ govukWarningText({
          text: t("person-escort-record::locked"),
          iconFallbackText: "Warning"
        }) }}
      {% endif %}

      {% for key, step in summarySteps %}
        <section class="app-!-position-relative govuk-!-margin-bottom-8">
          <h2 class="govuk-heading-m govuk-!-margin-bottom-0 govuk-!-padding-bottom-1 govuk-!-padding-right-8 app-border-bottom-1">
            {{ step.pageTitle }}
          </h2>

          {% if canAccess('person_escort_record:update') and isEditable %}
            <p class="app-!-position-top-right">
              <a href="{{ step.stepUrl }}" class="govuk-link">
                <strong>{{ t("actions::change", {
                  context: "with_visually_hidden_text",
                  text: step.pageTitle
                }) | safe }}</strong>
              </a>
            </p>
          {% endif %}

          {{ govukSummaryList(step.summaryListComponent) }}
        </section>
      {% endfor %}
    </div>
  </div>

  {{ backLink() }}
{% endblock %}

{% block footer %}
  {% if PERSON_ESCORT_RECORD_FEEDBACK_URL %}
    {{ appFeedbackPrompt({
      content: {
        html: t("person-escort-record::feedback_prompt", {
          url: PERSON_ESCORT_RECORD_FEEDBACK_URL
        })
      }
    }) }}
  {% endif %}

  {{ super() }}
{% endblock %}
